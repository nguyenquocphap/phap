-- ⚔️ Auto bắn thường có nút bật/tắt cho mobile

local Players = game:GetService("Players")
local VirtualInput = game:GetService("VirtualInputManager")
local lp = Players.LocalPlayer
local autoShoot = false

-- Tạo GUI Toggle Button
local gui = Instance.new("ScreenGui", lp:WaitForChild("PlayerGui"))
gui.Name = "AutoShootToggle"

local button = Instance.new("TextButton", gui)
button.Size = UDim2.new(0, 120, 0, 40)
button.Position = UDim2.new(0.8, 0, 0.8, 0) -- góc dưới phải
button.Text = "AutoShoot: OFF"
button.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
button.TextColor3 = Color3.new(1, 1, 1)
button.Font = Enum.Font.SourceSansBold
button.TextSize = 18
button.BorderSizePixel = 2

button.MouseButton1Click:Connect(function()
    autoShoot = not autoShoot
    button.Text = "AutoShoot: " .. (autoShoot and "ON" or "OFF")
end)

-- Chờ nhân vật
local function getChar()
    return lp.Character or lp.CharacterAdded:Wait()
end

-- Tìm địch gần nhất
local function getNearestEnemy()
    local char = getChar()
    local root = char:FindFirstChild("HumanoidRootPart")
    if not root then return nil end

    local closest, dist = nil, math.huge
    for _, enemy in pairs(workspace:FindFirstChild("Enemies") and workspace.Enemies:GetChildren() or {}) do
        if enemy:FindFirstChild("Humanoid") and enemy:FindFirstChild("HumanoidRootPart") and enemy.Humanoid.Health > 0 then
            local d = (enemy.HumanoidRootPart.Position - root.Position).Magnitude
            if d < dist then
                closest = enemy
                dist = d
            end
        end
    end
    return closest
end

-- Vòng lặp bắn
spawn(function()
    while true do
        if autoShoot then
            local char = getChar()
            local root = char:FindFirstChild("HumanoidRootPart")
            local target = getNearestEnemy()

            if root and target then
                root.CFrame = CFrame.new(root.Position, target.HumanoidRootPart.Position)
                VirtualInput:SendMouseButtonEvent(0, 0, 0, true, game, 0)
                VirtualInput:SendMouseButtonEvent(0, 0, 0, false, game, 0)
            end
        end
        wait()
    end
end)
